<script>
const API="https://script.google.com/macros/s/AKfycbwcNKAqNPe3O0ZjDJ_E4HSRrNnlvnXmQ453h84DIuy-B-HWRKLQqkkhmARCdtia00IKNg/exec";
let names=[
"ام محمود","حليم","فاطمة","سارة","محمود","اسراء",
"دانيا","سعاد","شام","محمد","بتول","عبدالله","حسن","جاد"
];

let parts=30;
let table=document.getElementById("tbl");

// تحميل البيانات
fetch(API).then(r=>r.json()).then(data=>{
 let db=data.slice(1);

 let header="<tr><th>الاسم</th>";
 for(let i=1;i<=parts;i++) header+="<th>"+i+"</th>";
 header+="</tr>";
 table.innerHTML+=header;

 names.forEach(name=>{
   let row="<tr><th>"+name+"</th>";
   for(let i=1;i<=parts;i++){
     let found=db.find(x=>x[0]==name && x[1]==i && x[2]==1);
     let checked=found?"checked":"";
     row+=`<td><input type="checkbox" ${checked}
     onchange="save('${name}',${i},this.checked)"></td>`;
   }
   row+="</tr>";
   table.innerHTML+=row;
 });
});

function save(name,part,val){
 fetch(API,{
   method:"POST",
   body:JSON.stringify({name:name,part:part,done:val?1:0})
 });
}
</script>
