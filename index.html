<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø®ØªÙ…Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©</title>

<style>
body{
  font-family:Arial;
  background:#f5f7fb;
  text-align:center;
}
h1{color:#2e7d32}
table{
  border-collapse:collapse;
  margin:auto;
  background:white;
}
td,th{
  border:1px solid #ddd;
  padding:6px;
  font-size:14px;
}
th{
  background:#4CAF50;
  color:white;
}
input{width:18px;height:18px}
button{
  margin:15px;
  padding:10px 20px;
  font-size:18px;
  background:#2e7d32;
  color:white;
  border:none;
  border-radius:8px;
}
</style>
</head>

<body>

<h1>ğŸ“– Ø®ØªÙ…Ø© Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠØ©</h1>
<p>Ø§Ø¶ØºØ· âœ”ï¸ Ø«Ù… Ø§Ø¶ØºØ· Ø²Ø± Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù…</p>

<button onclick="saveData()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯Ù…</button>

<table id="tbl"></table>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const API = "PUT_YOUR_WEBAPP_URL_HERE"; // Ø±Ø§Ø¨Ø· Google Apps Script Web App
  const names = [
    "Ø§Ù… Ù…Ø­Ù…ÙˆØ¯","Ø­Ù„ÙŠÙ…","ÙØ§Ø·Ù…Ø©","Ø³Ø§Ø±Ø©","Ù…Ø­Ù…ÙˆØ¯","Ø§Ø³Ø±Ø§Ø¡",
    "Ø¯Ø§Ù†ÙŠØ§","Ø³Ø¹Ø§Ø¯","Ø´Ø§Ù…","Ù…Ø­Ù…Ø¯","Ø¨ØªÙˆÙ„","Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡","Ø­Ø³Ù†","Ø¬Ø§Ø¯"
  ];
  const parts = 30;

  const table = document.getElementById("tbl");
  if (!table) {
    console.error("Table #tbl not found. Make sure you have <table id='tbl'></table> in HTML.");
    return;
  }

  fetch(API)
    .then(r => r.json())
    .then(data => {
      const db = data.slice(1); // ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ù‡ÙŠØ¯Ø± name/part/done

      let header = "<tr><th>Ø§Ù„Ø§Ø³Ù…</th>";
      for (let i = 1; i <= parts; i++) header += `<th>${i}</th>`;
      header += "</tr>";
      table.innerHTML = header;

      names.forEach(name => {
        let row = `<tr><th>${name}</th>`;
        for (let i = 1; i <= parts; i++) {
          const found = db.find(x => x[0] === name && Number(x[1]) === i && Number(x[2]) === 1);
          const checked = found ? "checked" : "";
          row += `<td><input type="checkbox" ${checked} data-name="${name}" data-part="${i}"></td>`;
        }
        row += "</tr>";
        table.innerHTML += row;
      });

      table.addEventListener("change", (e) => {
        if (e.target && e.target.type === "checkbox") {
          const name = e.target.dataset.name;
          const part = Number(e.target.dataset.part);
          const done = e.target.checked ? 1 : 0;

          fetch(API, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ name, part, done })
          }).catch(err => console.error("Save failed:", err));
        }
      });
    })
    .catch(err => console.error("Fetch failed:", err));
});
</script>

</body>
</html>
